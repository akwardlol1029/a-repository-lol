local char = game.Players.LocalPlayer.Character

--speed = 100 (copy on executor)

local cf = char:GetPivot()

local on = false

print('noclip script executed')

game.UserInputService.InputBegan:Connect(function(i, e)
    if not e then
        if i.KeyCode == Enum.KeyCode.E then
            cf = char:GetPivot()
            on = not on
            if on then
                while (char.Humanoid.Health > 0) and on do
                    local dT = task.wait()
                    --print(char.Humanoid.MoveDirection)
                    local x,y,z = workspace.CurrentCamera.CFrame:ToOrientation()
                    cf = CFrame.new(cf.Position) * CFrame.Angles(workspace.CurrentCamera.CFrame.RightVector * x, 0, 0)
                    cf *= CFrame.new(char.Humanoid.MoveDirection * speed * dT)
                    cf *= CFrame.Angles(0, 0, workspace.CurrentCamera.CFrame.LookVector * z) * CFrame.Angles(0, workspace.CurrentCamera.CFrame.UpVector * y, 0)
                    char:PivotTo(cf)
                end
            end
        end
    end
end)

game.Players.LocalPlayer.CharacterAdded:Connect(function(c)
    char = c
end)
